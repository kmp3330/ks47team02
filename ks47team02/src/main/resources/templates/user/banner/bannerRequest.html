<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org/"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{user/layout/default}">
<head>
  <link rel="stylesheet" type="text/css" th:href="@{/css/table.css}"/>
  <link rel="stylesheet" th:href="@{/user/assets/css/banner.css}">
  
  <style>
    
    input{
      width: 98%;
      height: 23px;
    }
    td:nth-child(3n+1):not(:last-child){
      color: white;
      font-weight: 700;
      background-color: cornflowerblue;
    }
    select{
      width: 99%;
      text-align: center;
      height: 23px;
    }
    #idCheck{
      width: 99%;
      height: 25px;
    }
    #addMemberBtn, #resetBtn {
      width: 49%;
      height: 25px;
    }
    
    .parent-element-class {
      overflow: auto;
    }
    
    .overflowing-text-element-class {
      word-wrap: break-word;
      white-space: normal;
    }
    .custom-select{
      padding-bottom: 3rem;
      font-size: 20px;
    }
    .nice-select span.current {
      font-size: 20px;
      display: inline-block;
      line-height: 56px;
    }
  </style>
</head>

<th:block layout:fragment="customJs">
  <script th:src="@{/js/jquery-3.7.0.js}"></script>
  <script>
    /*
    const $idCheckBtn = document.querySelector('#idCheck');
    $idCheckBtn.addEventListener('click', e => {
      alert('test');
    });
    */
    // 유효성검사 함수
    const validCheck = element => {
      let data = $(element).val();
      let eleId = $(element).attr('id');
      if(typeof data == 'undefined' || data == null || data == '' ){
        let cate = $(`label[for="${eleId}"]`).text();
        alert(`${cate} 필수 입력항목입니다.`);
        $(element).focus();
        return false;
      }
      return true;
    }
    
    // 회원아이디 변경 시 이벤트 처리
    $('#memberId').change(function(){
      $('#addMemberForm input').not('#memberId').val('');
      $('#addMemberForm input').not('#memberId').prop('disabled', true);
      $('#addMemberForm select').prop('disabled', true);
      $('#addMemberForm button').not('#idCheck').prop('disabled', true);
    });
    
    // 회원 가입 버튼 시 이벤트
    $('#addMemberBtn').click(function(){
      const validateEle = $('#addMemberForm input').not('#memberId');
      let isSubmit =  false;
      validateEle.each((idx, item) => {
        isSubmit = validCheck(item);
        return isSubmit;
      })
      if(isSubmit) $('#addMemberForm').submit();
    });
    
    // 입력 취소 버튼 클릭시 이벤트 처리
    $('#resetBtn').click(function(e){
      // 태그가 가지고 있는 기본 이벤트 동작 방지
      e.preventDefault();
      $('#addMemberForm input').not('#memberId').val('');
    });
    
    // 아이디중복버튼 이벤트
    $('#idCheck').click(function(){
      const $memberId = $('#memberId');
      let memberId = $memberId.val();
      
      // 유효성검사
      let valid = validCheck($memberId);
      if(!valid) return false;
      
      // ajax 호출
      const request = $.ajax({
        url: '/member/idCheck',
        method: 'POST',
        data: { 'memberId' : memberId },
        dataType: 'text'
      });
      
      request.done(function( response ) {
        if(response == 'true'){
          alert('이미 등록된 아이디입니다.');
          $memberId.val('');
          $memberId.focus();
          return false;
        }else{
          $('#addMemberForm input').prop('disabled', false);
          $('#addMemberForm select').prop('disabled', false);
          $('#addMemberForm button').prop('disabled', false);
        }
        //console.log(response);
      });
      
      request.fail(function( jqXHR, textStatus ) {
        alert( "Request failed: " + textStatus );
      });
      
    });
  </script>
</th:block>


<th:block layout:fragment="customContents">
  
  <form id="requestForm" th:action="@{/banner/bannerRequest}" method="post">
    <div class="row">
      <div class="col-lg-3">
        <div class="sidebar">
          <div class="single-item mb-4">
            <h4 class="mb-4">배너 광고</h4>
            <a th:href="@{/profile/profileIntroList}"
               class="sidebar-btn d-flex justify-content-between mb-3"> <span>광고 문의</span>
            </a> <a th:href="@{/profile/profileSkillList}"
                    class="sidebar-btn d-flex justify-content-between mb-3"> <span>광고 신청</span>
          </a> <a th:href="@{/profile/profileWorkSpecList}"
                  class="sidebar-btn d-flex justify-content-between mb-3"> <span>광고 신청 현황</span>
          </a> <a th:href="@{/profile/profileEduSpecList}"
                  class="sidebar-btn d-flex justify-content-between mb-3"> <span>광고 진행 현황</span>
          </a>
          </div>
        </div>
      </div>
      <div class="col-md-9">
        <div class="card card-primary">
          <div class="card-header">
            <h3 class="card-title">배너광고 신청</h3>
            
            <div class="card-tools">
              <button type="button" class="btn btn-tool" data-card-widget="collapse" title="Collapse">
                <i class="fas fa-minus"></i>
              </button>
            </div>
          </div>
          <div class="card-body">
            <div class="form-group">
              <label for="inputName">Project Name</label>
              <input type="text" id="inputName" class="form-control">
            </div>
            <div class="form-group">
              <label for="inputDescription">Project Description</label>
              <textarea id="inputDescription" class="form-control" rows="4"></textarea>
            </div>
            <div class="form-group">
              <label for="inputStatus">Status</label>
              <select id="inputStatus" class="form-control custom-select">
                <option selected="" disabled="">광고 유형을 선택하세요</option>
                <option>On Hold</option>
                <option>Canceled</option>
                <option>Success</option>
              </select>
            </div>
            <div class="form-group">
              <label for="inputClientCompany">Client Company</label>
              <input type="text" id="inputClientCompany" class="form-control">
            </div>
            <div class="form-group">
              <label for="inputProjectLeader">Project Leader</label>
              <input type="text" id="inputProjectLeader" class="form-control">
            </div>
          </div>
          <!-- /.card-body -->
        </div>
        <!-- /.card -->
      </div>
      <!--<div class="col-lg-9">
        <div class="single-job mb-4 justify-content-between text-center">
          <div class="card">
            <div class="card-header border-0">
              <h3 class="mb-0 title_color">배너 신청</h3>
              <table class="table table-striped table-valign-middle">
                <tr>
                  <td>
                    <label for="bannerRequestCompanyName">기업이름</label>
                  </td>
                  <td colspan="2">
                    <input type="text" id="bannerRequestCompanyName" name="bannerRequestCompanyName"
                           placeholder="회원의 비밀번호를 입력해주세요."/>
                  </td>
                </tr>
                <tr>
                  <td>
                    <label for="bannerUnitPriceCode">배너 단가코드</label>
                  </td>
                  <td colspan="2">
                    <input type="text" id="bannerUnitPriceCode" name="bannerUnitPriceCode"
                           placeholder="회원의 이름을 입력해주세요."/>
                  </td>
                </tr>
                <tr>
                  <td>
                    <label for="bannerLocation">배너위치</label>
                  </td>
                  <td colspan="2">
                    <input type="text" id="bannerLocation" name="bannerLocation"
                           placeholder="회원의 이름을 입력해주세요."/>
                  </td>
                </tr>
                <tr>
                  <td>
                    <label for="bannerPeriod">배너기간</label>
                  </td>
                  <td colspan="2">
                    <input type="text" id="bannerPeriod" name="bannerPeriod" />
                  </td>
                </tr>
                <tr>
                  <td>
                    <label for="bannerPrice">배너가격</label>
                  </td>
                  <td colspan="2">
                    <input type="text" id="bannerPrice" name="bannerPrice"
                           placeholder="회원의 이름을 입력해주세요."/>
                  </td>
                </tr>
                <tr>
                  <td colspan="3">
                    <button type="button" id="addMemberBtn" disabled="disabled">신청완료</button>
                    <button type="reset" id="resetBtn" disabled="disabled">신청취소</button>
                  </td>
                </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>-->
    </div>
    </div>
  </form>
</th:block>
</html>